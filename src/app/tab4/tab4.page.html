<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Administración</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="presentPopover($event)">
        <ion-icon slot="icon-only" name="menu-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
  <div class="searchbar-container">
    <ion-searchbar
      [(ngModel)]="searchQuery"
      (ionInput)="filtrarUsuarios()"
      class="custom-searchbar"
      placeholder="Buscar usuario por nombre">
    </ion-searchbar>
  </div>
</ion-header>




<!-- Asegúrate de agregar la clase custom-background -->
<ion-content [fullscreen]="true" class="custom-background">
  
    <ng-container *ngIf="selectedSegment === 'user-management'">
      <ion-list>
        <div class="usuario-card" *ngFor="let usuario of usuariosPaginados">
          <ion-label>
            <h2>{{ usuario.name }}</h2>
            <p>Email: {{ usuario.email }}</p>
            <p>Rol actual: {{ usuario.role }}</p>
          </ion-label>
  
          <div class="botones-container">
            <ion-button fill="outline" color="primary" (click)="mostrarSelectorRol(usuario)">
              <ion-icon name="person-outline" slot="start"></ion-icon>
              Cambiar Rol
            </ion-button>

            <ion-button fill="outline" color="danger" (click)="confirmarEliminacionUsuario(usuario)">
              <ion-icon name="trash-outline" slot="start"></ion-icon>
              Eliminar
            </ion-button>
            
          </div>
        </div>
      </ion-list>
      <ion-item>
      </ion-item>
    </ng-container>

  
  


  <ng-container *ngIf="selectedSegment === 'manage-posts'">
    <ion-list *ngIf="publicaciones && publicaciones.length > 0">
      <div class="publicacion-card" *ngFor="let publicacion of publicaciones">
        <ion-img [src]="publicacion?.imagenURL || 'assets/default-avatar.png'" class="mascota-img"></ion-img>
  
        <ion-label>
          <h2>{{ publicacion?.mascota?.nombre || 'Nombre desconocido' }}</h2>
          <p>Raza: {{ publicacion?.mascota?.raza || 'Desconocida' }}</p>
          <p>Edad: {{ publicacion?.mascota?.edad || 'No disponible' }} años</p>
          <p>Sexo: {{ publicacion?.mascota?.sexo || 'No especificado' }}</p>
          <p>Personalidad: {{ publicacion?.mascota?.personalidad?.join(', ') || 'Sin especificar' }}</p>
          <p>Tipo: {{ publicacion?.mascota?.tipo || 'No especificado' }}</p>
          <p>Estado de salud: {{ publicacion?.mascota?.estadoSalud || 'No disponible' }}</p>
          <p>Descripción: {{ publicacion?.mascota?.descripcion || 'Sin descripción' }}</p>
        </ion-label>
  
        <div class="botones-container">
          <ion-button fill="outline" color="primary" (click)="openUpdateModal(publicacion)">
            <ion-icon name="create-outline" slot="start"></ion-icon>
            Actualizar
          </ion-button>
          <ion-button fill="outline" color="danger" (click)="eliminarPublicacion(publicacion)">
            <ion-icon name="trash-outline" slot="start"></ion-icon>
            Eliminar
          </ion-button>
        </div>
      </div>
    </ion-list>
  
    <ion-item *ngIf="publicaciones.length === 0">
      <ion-label>No hay publicaciones disponibles.</ion-label>
    </ion-item>
      <ion-item>
      </ion-item>
  </ng-container>

  <ng-container *ngIf="selectedSegment === 'adoption-requests'">
    <ion-list *ngFor="let publicacion of publicaciones">
      <ion-card>
        <!-- Imagen y nombre de la mascota -->
        <img [src]="publicacion.imagenURL" alt="Imagen de la mascota" />
        <ion-card-header>
          <ion-card-title>{{ publicacion.mascota?.nombre || 'Nombre desconocido' }}</ion-card-title>
        </ion-card-header>
  
        <!-- Botón para ver las solicitudes -->
        <ion-card-content>
          <ion-button expand="block" (click)="toggleSolicitudes(publicacion)">
            Ver solicitudes
          </ion-button>
        </ion-card-content>
  
        <!-- Sección de solicitudes -->
        <ion-list *ngIf="publicacion.mostrarSolicitudes">
          <div *ngFor="let solicitud of publicacion.solicitudes">
            <ion-item>
              <ion-label>
                <h2>Solicitante: {{ solicitud.nombreCompleto || 'Nombre desconocido' }}</h2>
                <p>Email: {{ solicitud.nombreUsuarioSolicitante || 'Usuario desconocido' }}</p>
                <p>Fecha: {{ solicitud.fecha?.toDate() | date: 'medium' }}</p>
                <p>Estado: {{ solicitud.estado || 'Pendiente' }}</p>
              </ion-label>
              
              <ion-button (click)="abrirSolicitudModal(solicitud)">Ver solicitud</ion-button>
            </ion-item>
          </div>
          <div class="botones-container">

          </div>
        </ion-list>
      </ion-card>
    </ion-list>
  </ng-container>
  

  
 

  <ng-container *ngIf="selectedSegment === 'reports'">
    <ion-card id="printable-report">  <!-- ID para el reporte imprimible -->
      <ion-card-header>
        <ion-card-title>Reportes de la Aplicación</ion-card-title>
      </ion-card-header>
  
      <ion-card-content>
        <ion-item>
          <ion-label>Total de Usuarios: {{ totalUsuarios }}</ion-label>
        </ion-item>
        <ion-item>
          <ion-label>Total de Publicaciones: {{ totalPublicaciones }}</ion-label>
        </ion-item>
        <ion-item>
          <ion-label>Solicitudes Aprobadas: {{ totalSolicitudesAprobadas }}</ion-label>
        </ion-item>
        <ion-item>
          <ion-label>Solicitudes Pendientes: {{ totalSolicitudesPendientes }}</ion-label>
        </ion-item>
        <ion-item>
          <ion-label>Solicitudes Rechazadas: {{ totalSolicitudesRechazadas }}</ion-label>
        </ion-item>
  
        <ion-card *ngIf="chartOptions && chartOptions.series.length > 0">
          <ion-card-header>
            <ion-card-title>Gráfico de Estadísticas</ion-card-title>
          </ion-card-header>
          <ion-card-content>
            <div #chartRef>
              <apx-chart 
                [series]="chartOptions.series"
                [chart]="chartOptions.chart"
                [labels]="chartOptions.labels"
                [legend]="chartOptions.legend"
                [title]="chartOptions.title"
                [colors]="chartOptions.colors">
              </apx-chart>
            </div>
          </ion-card-content>
        </ion-card>
      </ion-card-content>
    </ion-card>
  
<!-- Botón para descargar el PDF -->
<ion-button expand="full" (click)="exportarReportePDF()">
  <ion-icon name="download-outline" slot="start"></ion-icon>
  Descargar Reporte en PDF
</ion-button>

<!-- Botón para descargar el reporte en Excel -->
<ion-button expand="full" (click)="exportarReporteExcel()">
  <ion-icon name="download-outline" slot="start"></ion-icon>
  Descargar Reporte en Excel
</ion-button>

<!-- Botón para imprimir el reporte -->
<ion-button expand="full" (click)="imprimirReporte()">
  <ion-icon name="print-outline" slot="start"></ion-icon>
  Imprimir Reporte
</ion-button>


    <ion-item>
    </ion-item>
    <ion-item>
    </ion-item>
  
  </ng-container>

  
  
</ion-content>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
